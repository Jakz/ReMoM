;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	   Copyright (c) 2009 by Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: AC-7625-2E2D-92			    |
; |				 Valued	Client				    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	AABF5C934234A70885DEA7A0C8B3B5DE


    Ideal
    include uni.inc ; see unicode subdir of ida	for info on unicode

    p386n
    model large

    include "__MAGIC.inc"



; Segment type:	Pure code
segment	seg002 byte public 'CODE' use16
    assume cs:seg002
    ;org 2
    assume es:nothing, ss:nothing, ds:dseg, fs:nothing,	gs:nothing



proc f020105_bios_timeofday far
es_BIOS_Data_Area = es	; BIOS Data Area (BDA) @ 0x0400
    push es_BIOS_Data_Area
    mov	ax, 0
    mov	es_BIOS_Data_Area, ax
    assume es:nothing
    mov	ax, [es_BIOS_Data_Area:DAILY_TIMER_COUNTER_lw]
    mov	[bios_time_lw],	ax
    mov	ax, [es_BIOS_Data_Area:DAILY_TIMER_COUNTER_hw]
    mov	[bios_time_hw],	ax
    pop	es_BIOS_Data_Area
    assume es:nothing
    retf
endp f020105_bios_timeofday




proc f020205_idk_DIFF_bios_time_lw far
    push es
    mov	ax, 0
    mov	es, ax
    assume es:nothing
    mov	ax, [es:DAILY_TIMER_COUNTER_lw]
    sub	ax, [bios_time_lw]
    pop	es
    assume es:nothing
    retf
endp f020205_idk_DIFF_bios_time_lw



; Attributes: bp-based frame

proc f020305_idk_SleepWaitPause	far

arg_0= word ptr	 6

    push bp
    mov	bp, sp
    sub	sp, 2
    push es
    push ds
    push si
    push di
    jmp	short LOOP
    db 90h

loc_13F55:
    pop	di
    pop	si
    pop	ds
    pop	es
    mov	sp, bp
    pop	bp
    retf

LOOP:
    mov	ax, 0
    mov	es, ax
    assume es:nothing
    mov	ax, [es:DAILY_TIMER_COUNTER_lw]
    sub	ax, [bios_time_lw]
    js	short loc_13F55

loc_13F6C:
    cmp	ax, 4
    jns	short loc_13F55
    sub	ax, [bp+arg_0]
    js	short LOOP
    pop	di
    pop	si
    pop	ds
    pop	es
    assume es:nothing
    mov	sp, bp
    pop	bp
    retf
endp f020305_idk_SleepWaitPause



; Attributes: bp-based frame

proc f020405_idk_CheckInputOrSleep_s13F7E far

arg_0= word ptr	 6

    push bp
    mov	bp, sp
    push es
    cmp	[word_359CC], 0
    jnz	short loc_13F8C

loc_13F89:
    pop	es
    pop	bp
    retf

loc_13F8C:
    call TestKeyPress
    cmp	ax, 0
    jz	short loc_13F99
    pop	es
    pop	bp
    retf

loc_13F99:
    call GetMouseButtonsStatus
    cmp	ax, 0
    jnz	short loc_13FAD
    call get_w360B4_set0
    cmp	ax, 0
    jz	short loc_13FB0

loc_13FAD:
    pop	es
    pop	bp
    retf

loc_13FB0:
    mov	ax, 0
    mov	es, bx
    mov	ax, [es:DAILY_TIMER_COUNTER_lw]
    mov	dx, [es:DAILY_TIMER_COUNTER_hw]
    sub	ax, [bios_time_lw]
    sbb	dx, [bios_time_hw]
    js	short loc_13F89
    cmp	dx, 0
    jnz	short loc_13F89

loc_13FCD:
    cmp	ax, 0
    js	short loc_13F89

loc_13FD2:
    cmp	ax, 400
    jns	short loc_13F89

loc_13FD7:
    sub	ax, [bp+arg_0]
    js	short loc_13F8C
    pop	es
    pop	bp
    retf
endp f020405_idk_CheckInputOrSleep_s13F7E




proc f020505_WaitForVsync far
    push es
    mov	dx, INPUT_STATUS

loc_13FE3:
    in	al, dx
    and	al, 8
    jnz	short loc_13FE3

loc_13FE8:
    in	al, dx
    and	al, 8
    jz	short loc_13FE8

loc_13FED:
    pop	es
    retf
endp f020505_WaitForVsync

ends seg002
